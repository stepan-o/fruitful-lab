@import "tailwindcss";

/* ------------------------------
   1) LIGHT defaults
------------------------------ */
:root {
    --background: #ffffff;
    --foreground: #171A21;

    /* Brand */
    --brand-heading: #0B132B;
    --brand-raspberry: #950952;
    --brand-alabaster: #DFDFDF;
    --brand-bronze: #D58936;
    --brand-rust: #A44200;

    /* Backdrop tuning (LIGHT) */
    --backdrop-opacity-soft: 0.08;
    --backdrop-opacity-strong: 0.12;
    --backdrop-blur: 2px;
    --backdrop-saturate: 1;
    --backdrop-contrast: 1;
    --backdrop-glow: 0px;

    /* Backdrop palette (LIGHT) */
    --backdrop-color-1: var(--brand-alabaster);
    --backdrop-color-2: var(--brand-raspberry);
    --backdrop-color-3: var(--brand-bronze);
    --backdrop-color-4: var(--brand-heading);

    --border: var(--brand-alabaster);
    --foreground-muted: rgba(23, 26, 33, 0.72);

    /* Start-here pill tokens (LIGHT) */
    --start-here-bg: var(--brand-bronze);
    --start-here-fg: var(--brand-heading);
    --start-here-dot: var(--background);
    --start-here-shadow: rgba(0, 0, 0, 0.08);

    /* Surfaces */
    --surface: rgba(11, 19, 43, 0.03);
    --card: rgba(255, 255, 255, 0.72);
    --card-hover: rgba(255, 255, 255, 0.9);

    --font-heading: ui-sans-serif;
    --font-body: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji";
}

@theme inline {
    --color-background: var(--background);
    --color-foreground: var(--foreground);
}

/* ------------------------------
   2) DARK variables (as a reusable block)
   - used by both prefers-color-scheme + manual override
------------------------------ */
:root[data-theme="dark"],
html[data-theme="dark"] {
    --background: #0a0a0a;
    --foreground: #ededed;

    --brand-heading: #E7ECFF;
    --brand-alabaster: rgba(255, 255, 255, 0.14);

    --brand-raspberry: #B0126D;
    --brand-bronze: #F0A14A;
    --brand-rust: #D15A1A;

    --backdrop-opacity-soft: 0.26;
    --backdrop-opacity-strong: 0.42;
    --backdrop-blur: 1px;
    --backdrop-saturate: 1.55;
    --backdrop-contrast: 1.15;
    --backdrop-glow: 140px;

    --backdrop-color-1: rgba(255, 255, 255, 1);
    --backdrop-color-2: rgba(176, 18, 109, 1);
    --backdrop-color-3: rgba(240, 161, 74, 1);
    --backdrop-color-4: rgba(231, 236, 255, 1);

    --border: rgba(255, 255, 255, 0.12);
    --foreground-muted: rgba(237, 237, 237, 0.72);

    /* Start-here pill tokens (DARK) */
    --start-here-bg: rgba(240, 161, 74, 0.14);
    --start-here-fg: var(--foreground);
    --start-here-dot: var(--brand-bronze);
    --start-here-shadow: rgba(0, 0, 0, 0.25);

    --surface: rgba(255, 255, 255, 0.06);
    --card: rgba(255, 255, 255, 0.04);
    --card-hover: rgba(255, 255, 255, 0.06);
}

/* ------------------------------
   3) EXPLICIT LIGHT override (optional clarify)
------------------------------ */
:root[data-theme="light"],
html[data-theme="light"] {
    /* light is the default; this block exists so toggle can force light */
}

/* ------------------------------
   4) OS preference fallback (only when user has NOT set data-theme)
------------------------------ */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
        --background: #0a0a0a;
        --foreground: #ededed;

        --brand-heading: #E7ECFF;
        --brand-alabaster: rgba(255, 255, 255, 0.14);

        --brand-raspberry: #B0126D;
        --brand-bronze: #F0A14A;
        --brand-rust: #D15A1A;

        --backdrop-opacity-soft: 0.26;
        --backdrop-opacity-strong: 0.42;
        --backdrop-blur: 1px;
        --backdrop-saturate: 1.55;
        --backdrop-contrast: 1.15;
        --backdrop-glow: 140px;

        --backdrop-color-1: rgba(255, 255, 255, 1);
        --backdrop-color-2: rgba(176, 18, 109, 1);
        --backdrop-color-3: rgba(240, 161, 74, 1);
        --backdrop-color-4: rgba(231, 236, 255, 1);

        --border: rgba(255, 255, 255, 0.12);
        --foreground-muted: rgba(237, 237, 237, 0.72);

        --surface: rgba(255, 255, 255, 0.06);
        --card: rgba(255, 255, 255, 0.04);
        --card-hover: rgba(255, 255, 255, 0.06);
    }
}

body {
    background: var(--background);
    color: var(--foreground);
}

.font-heading { font-family: var(--font-heading), serif; }
.font-body { font-family: var(--font-body), system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }

/* Backdrop circles: CSS controls pop per theme */
.lab-backdrop-circle {
    filter: blur(var(--backdrop-blur))
    saturate(var(--backdrop-saturate))
    contrast(var(--backdrop-contrast));
    will-change: transform;
    box-shadow: 0 0 var(--backdrop-glow) currentColor;
}

/* ✅ IMPORTANT FIX:
   mix-blend-mode must follow the *effective theme*, not only OS preference */
:root[data-theme="dark"] .lab-backdrop-circle,
html[data-theme="dark"] .lab-backdrop-circle {
    mix-blend-mode: screen;
}
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) .lab-backdrop-circle {
        mix-blend-mode: screen;
    }
}

/* ------------------------------
   ThemeToggle segmented control styling
   (works with your current ThemeToggle markup)
------------------------------ */
.theme-toggle {
    position: relative;
    padding: 2px;
    gap: 0; /* override the Tailwind gap-2 you still have */
    border-radius: 9999px;
}

/* Hide the dot (optional). Keep it if you want, but segmented looks cleaner */
.theme-toggle-dot {
    display: none;
}

/* Two labels behave like two segments */
.theme-toggle-label-light,
.theme-toggle-label-dark {
    position: relative;
    z-index: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px 10px;
    min-width: 46px;
    font-size: 12px;
    line-height: 1;
    border-radius: 9999px;
    user-select: none;
}

/* Sliding “thumb” */
.theme-toggle::before {
    content: "";
    position: absolute;
    inset: 2px auto 2px 2px;
    width: calc(50% - 2px);
    border-radius: 9999px;
    background: var(--card-hover);
    transition: transform 160ms ease;
    box-shadow: 0 1px 0 rgba(0,0,0,0.08);
}

/* Default (light active) */
.theme-toggle-label-light { opacity: 1; }
.theme-toggle-label-dark { opacity: 0.72; }

/* Dark active (manual) */
:root[data-theme="dark"] .theme-toggle::before,
html[data-theme="dark"] .theme-toggle::before {
    transform: translateX(100%);
}
:root[data-theme="dark"] .theme-toggle-label-light,
html[data-theme="dark"] .theme-toggle-label-light {
    opacity: 0.72;
}
:root[data-theme="dark"] .theme-toggle-label-dark,
html[data-theme="dark"] .theme-toggle-label-dark {
    opacity: 1;
}

/* Dark active (OS fallback when no explicit theme) */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) .theme-toggle::before {
        transform: translateX(100%);
    }
    :root:not([data-theme]) .theme-toggle-label-light { opacity: 0.72; }
    :root:not([data-theme]) .theme-toggle-label-dark { opacity: 1; }
}

@keyframes hubPulse {
    0% { opacity: 0.35; transform: scale(1); }
    50% { opacity: 0.18; transform: scale(1.04); }
    100% { opacity: 0.35; transform: scale(1); }
}

@keyframes start-here-pulse {
    0% { opacity: 0; transform: scale(0.9); }
    40% { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(0.9); }
}
