/* frontend/app/globals.css */
@import "tailwindcss";

/* ------------------------------
   1) LIGHT defaults
------------------------------ */
:root {
    --background: #ffffff;
    --foreground: #171a21;

    /* Brand */
    --brand-heading: #0b132b;
    --brand-raspberry: #950952;
    --brand-alabaster: #dfdfdf;
    --brand-bronze: #d58936;
    --brand-rust: #a44200;

    /* Backdrop tuning (LIGHT) */
    --backdrop-opacity-soft: 0.08;
    --backdrop-opacity-strong: 0.12;
    --backdrop-blur: 2px;
    --backdrop-saturate: 1;
    --backdrop-contrast: 1;
    --backdrop-glow: 0px;

    /* Backdrop palette (LIGHT) */
    --backdrop-color-1: var(--brand-alabaster);
    --backdrop-color-2: var(--brand-raspberry);
    --backdrop-color-3: var(--brand-bronze);
    --backdrop-color-4: var(--brand-heading);

    --border: var(--brand-alabaster);
    --foreground-muted: rgba(23, 26, 33, 0.72);

    /* Start-here pill tokens (LIGHT) */
    --start-here-bg: var(--brand-bronze);
    --start-here-fg: var(--brand-heading);
    --start-here-dot: var(--background);
    --start-here-shadow: rgba(0, 0, 0, 0.08);

    /* Surfaces */
    --surface: rgba(11, 19, 43, 0.03);
    --card: rgba(255, 255, 255, 0.72);
    --card-hover: rgba(255, 255, 255, 0.9);

    --toast-bg: rgba(255, 255, 255, 0.85);
    --toast-border: var(--brand-alabaster);

    /* Error */
    --toast-error-accent: var(--brand-rust);
    --toast-error-title: var(--brand-rust);
    --toast-error-text: var(--foreground);

    /* Success */
    --toast-success-accent: var(--brand-bronze);
    --toast-success-title: var(--brand-bronze);
    --toast-success-text: var(--foreground);

    --font-heading: ui-sans-serif;
    --font-body: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji";

    /* -----------------------------------
       PPC (Pinterest Potential Calculator)
       - polish tokens (LIGHT)
    ----------------------------------- */
    --ppc-accent-stroke: color-mix(in srgb, var(--brand-raspberry) 70%, transparent);
    --ppc-accent-stroke-2: color-mix(in srgb, var(--brand-bronze) 55%, transparent);
    --ppc-panel-bg: color-mix(in srgb, var(--card) 92%, transparent);
    --ppc-panel-inner: rgba(255, 255, 255, 0.18);
    --ppc-chip-bg: rgba(255, 255, 255, 0.72);
    --ppc-chip-border: color-mix(in srgb, var(--border) 65%, transparent);
    --ppc-noise-opacity: 0.06;
    --ppc-cta-shadow: rgba(0, 0, 0, 0.14);
}

@theme inline {
    --color-background: var(--background);
    --color-foreground: var(--foreground);
}

/* ------------------------------
   2) DARK variables (as a reusable block)
   - used by both prefers-color-scheme + manual override
------------------------------ */
:root[data-theme="dark"],
html[data-theme="dark"] {
    --background: #0a0a0a;
    --foreground: #ededed;

    --brand-heading: #e7ecff;
    --brand-alabaster: rgba(255, 255, 255, 0.14);

    --brand-raspberry: #b0126d;
    --brand-bronze: #f0a14a;
    --brand-rust: #d15a1a;

    --backdrop-opacity-soft: 0.26;
    --backdrop-opacity-strong: 0.42;
    --backdrop-blur: 1px;
    --backdrop-saturate: 1.55;
    --backdrop-contrast: 1.15;
    --backdrop-glow: 140px;

    --backdrop-color-1: rgba(255, 255, 255, 1);
    --backdrop-color-2: rgba(176, 18, 109, 1);
    --backdrop-color-3: rgba(240, 161, 74, 1);
    --backdrop-color-4: rgba(231, 236, 255, 1);

    --border: rgba(255, 255, 255, 0.12);
    --foreground-muted: rgba(237, 237, 237, 0.72);

    /* Start-here pill tokens (DARK) */
    --start-here-bg: rgba(240, 161, 74, 0.14);
    --start-here-fg: var(--foreground);
    --start-here-dot: var(--brand-bronze);
    --start-here-shadow: rgba(0, 0, 0, 0.25);

    --toast-bg: rgba(255, 255, 255, 0.06);
    --toast-border: rgba(255, 255, 255, 0.18);

    --toast-error-accent: var(--brand-rust);
    --toast-error-title: var(--brand-heading);
    --toast-error-text: var(--foreground);

    --toast-success-accent: var(--brand-bronze);
    --toast-success-title: var(--brand-heading);
    --toast-success-text: var(--foreground);

    --surface: rgba(255, 255, 255, 0.06);
    --card: rgba(255, 255, 255, 0.04);
    --card-hover: rgba(255, 255, 255, 0.06);

    /* PPC polish tokens (DARK) */
    --ppc-accent-stroke: color-mix(in srgb, var(--brand-raspberry) 62%, transparent);
    --ppc-accent-stroke-2: color-mix(in srgb, var(--brand-bronze) 54%, transparent);
    --ppc-panel-bg: rgba(255, 255, 255, 0.035);
    --ppc-panel-inner: rgba(255, 255, 255, 0.06);
    --ppc-chip-bg: rgba(10, 10, 10, 0.55);
    --ppc-chip-border: rgba(255, 255, 255, 0.16);
    --ppc-noise-opacity: 0.10;
    --ppc-cta-shadow: rgba(0, 0, 0, 0.45);
}

/* ------------------------------
   3) EXPLICIT LIGHT override (optional clarify)
------------------------------ */
:root[data-theme="light"],
html[data-theme="light"] {
    /* light is the default; this block exists so toggle can force light */
}

/* ------------------------------
   4) OS preference fallback (only when user has NOT set data-theme)
------------------------------ */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
        --background: #0a0a0a;
        --foreground: #ededed;

        --brand-heading: #e7ecff;
        --brand-alabaster: rgba(255, 255, 255, 0.14);

        --brand-raspberry: #b0126d;
        --brand-bronze: #f0a14a;
        --brand-rust: #d15a1a;

        --backdrop-opacity-soft: 0.26;
        --backdrop-opacity-strong: 0.42;
        --backdrop-blur: 1px;
        --backdrop-saturate: 1.55;
        --backdrop-contrast: 1.15;
        --backdrop-glow: 140px;

        --backdrop-color-1: rgba(255, 255, 255, 1);
        --backdrop-color-2: rgba(176, 18, 109, 1);
        --backdrop-color-3: rgba(240, 161, 74, 1);
        --backdrop-color-4: rgba(231, 236, 255, 1);

        --border: rgba(255, 255, 255, 0.12);
        --foreground-muted: rgba(237, 237, 237, 0.72);

        --toast-bg: rgba(255, 255, 255, 0.06);
        --toast-border: rgba(255, 255, 255, 0.18);

        --toast-error-accent: var(--brand-rust);
        --toast-error-title: var(--brand-heading);
        --toast-error-text: var(--foreground);

        --toast-success-accent: var(--brand-bronze);
        --toast-success-title: var(--brand-heading);
        --toast-success-text: var(--foreground);

        --surface: rgba(255, 255, 255, 0.06);
        --card: rgba(255, 255, 255, 0.04);
        --card-hover: rgba(255, 255, 255, 0.06);

        /* PPC polish tokens (DARK OS fallback) */
        --ppc-accent-stroke: color-mix(in srgb, var(--brand-raspberry) 62%, transparent);
        --ppc-accent-stroke-2: color-mix(in srgb, var(--brand-bronze) 54%, transparent);
        --ppc-panel-bg: rgba(255, 255, 255, 0.035);
        --ppc-panel-inner: rgba(255, 255, 255, 0.06);
        --ppc-chip-bg: rgba(10, 10, 10, 0.55);
        --ppc-chip-border: rgba(255, 255, 255, 0.16);
        --ppc-noise-opacity: 0.10;
        --ppc-cta-shadow: rgba(0, 0, 0, 0.45);
    }
}

body {
    background: var(--background);
    color: var(--foreground);
}

.font-heading {
    font-family: var(--font-heading), ui-sans-serif, system-ui, -apple-system,
    Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

.font-body {
    font-family: var(--font-body), ui-sans-serif, system-ui, -apple-system, Segoe UI,
    Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

/* Backdrop circles: CSS controls pop per theme */
.lab-backdrop-circle {
    filter: blur(var(--backdrop-blur)) saturate(var(--backdrop-saturate))
    contrast(var(--backdrop-contrast));
    will-change: transform;
    box-shadow: 0 0 var(--backdrop-glow) currentColor;
}

/* ✅ IMPORTANT FIX:
   mix-blend-mode must follow the *effective theme*, not only OS preference */
:root[data-theme="dark"] .lab-backdrop-circle,
html[data-theme="dark"] .lab-backdrop-circle {
    mix-blend-mode: screen;
}
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) .lab-backdrop-circle {
        mix-blend-mode: screen;
    }
}

/* ------------------------------
   ThemeToggle segmented control styling
   (works with your current ThemeToggle markup)
------------------------------ */
.theme-toggle {
    position: relative;
    padding: 2px;
    gap: 0; /* override the Tailwind gap-2 you still have */
    border-radius: 9999px;
}

/* Hide the dot (optional). Keep it if you want, but segmented looks cleaner */
.theme-toggle-dot {
    display: none;
}

/* Two labels behave like two segments */
.theme-toggle-label-light,
.theme-toggle-label-dark {
    position: relative;
    z-index: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px 10px;
    min-width: 46px;
    font-size: 12px;
    line-height: 1;
    border-radius: 9999px;
    user-select: none;
}

/* Sliding “thumb” */
.theme-toggle::before {
    content: "";
    position: absolute;
    inset: 2px auto 2px 2px;
    width: calc(50% - 2px);
    border-radius: 9999px;
    background: var(--card-hover);
    transition: transform 160ms ease;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.08);
}

/* Default (light active) */
.theme-toggle-label-light {
    opacity: 1;
}
.theme-toggle-label-dark {
    opacity: 0.72;
}

/* Dark active (manual) */
:root[data-theme="dark"] .theme-toggle::before,
html[data-theme="dark"] .theme-toggle::before {
    transform: translateX(100%);
}
:root[data-theme="dark"] .theme-toggle-label-light,
html[data-theme="dark"] .theme-toggle-label-light {
    opacity: 0.72;
}
:root[data-theme="dark"] .theme-toggle-label-dark,
html[data-theme="dark"] .theme-toggle-label-dark {
    opacity: 1;
}

/* Dark active (OS fallback when no explicit theme) */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) .theme-toggle::before {
        transform: translateX(100%);
    }
    :root:not([data-theme]) .theme-toggle-label-light {
        opacity: 0.72;
    }
    :root:not([data-theme]) .theme-toggle-label-dark {
        opacity: 1;
    }
}

@keyframes hubPulse {
    0% {
        opacity: 0.35;
        transform: scale(1);
    }
    50% {
        opacity: 0.18;
        transform: scale(1.04);
    }
    100% {
        opacity: 0.35;
        transform: scale(1);
    }
}

@keyframes start-here-pulse {
    0% {
        opacity: 0;
        transform: scale(0.9);
    }
    40% {
        opacity: 1;
        transform: scale(1);
    }
    100% {
        opacity: 0;
        transform: scale(0.9);
    }
}

/* ------------------------------
   Pinterest Potential
   - Welcome gradient + drift (moved from <style jsx>)
------------------------------ */
.ppc-welcome-gradient {
    pointer-events: none;
    position: absolute;
    inset: 0;
    overflow: hidden;
    opacity: 0.55; /* matches previous inline style */
}

/*
  Two large “highlight fields” that sweep across the whole card.
  Using oversized layers + translate creates visible motion (waves/ripples).
*/
.ppc-welcome-gradient::before,
.ppc-welcome-gradient::after {
    content: "";
    position: absolute;
    inset: -45%;
    background-repeat: no-repeat;
    filter: blur(44px) saturate(1.08);
    will-change: transform, background-position;
}

/* Layer A (dominant wave) */
.ppc-welcome-gradient::before {
    background-image: radial-gradient(
            900px circle at 15% 35%,
            color-mix(in srgb, var(--brand-raspberry) 52%, transparent) 0%,
            transparent 60%
    ),
    radial-gradient(
            760px circle at 55% 15%,
            color-mix(in srgb, var(--brand-raspberry) 38%, transparent) 0%,
            transparent 62%
    ),
    radial-gradient(
            820px circle at 85% 70%,
            color-mix(in srgb, var(--brand-raspberry) 34%, transparent) 0%,
            transparent 64%
    );
    animation: ppcWaveA 6.5s ease-in-out infinite;
    opacity: 0.9;
}

/* Layer B (counter-wave) */
.ppc-welcome-gradient::after {
    background-image: radial-gradient(
            860px circle at 80% 30%,
            color-mix(in srgb, var(--brand-raspberry) 46%, transparent) 0%,
            transparent 62%
    ),
    radial-gradient(
            720px circle at 25% 75%,
            color-mix(in srgb, var(--brand-raspberry) 30%, transparent) 0%,
            transparent 66%
    );
    animation: ppcWaveB 8.25s ease-in-out infinite;
    opacity: 0.75;
}

/* Corner glows traverse (animation only; keep opacity from Tailwind classes) */
.ppc-welcome-glow-1 {
    animation: ppcGlowTraverse1 7s ease-in-out infinite;
}
.ppc-welcome-glow-2 {
    animation: ppcGlowTraverse2 9s ease-in-out infinite;
}

/* WAVE: big sweeps across X + subtle Y */
@keyframes ppcWaveA {
    0% {
        transform: translate3d(-18%, -6%, 0) scale(1.02);
    }
    35% {
        transform: translate3d(6%, 4%, 0) scale(1.04);
    }
    70% {
        transform: translate3d(22%, -2%, 0) scale(1.03);
    }
    100% {
        transform: translate3d(-18%, -6%, 0) scale(1.02);
    }
}

/* COUNTER-WAVE: opposite direction so it feels like ripples */
@keyframes ppcWaveB {
    0% {
        transform: translate3d(22%, 8%, 0) scale(1.02);
    }
    40% {
        transform: translate3d(-4%, -2%, 0) scale(1.03);
    }
    80% {
        transform: translate3d(-22%, 5%, 0) scale(1.04);
    }
    100% {
        transform: translate3d(22%, 8%, 0) scale(1.02);
    }
}

/* Corner blobs traverse across the whole card */
@keyframes ppcGlowTraverse1 {
    0% {
        transform: translate3d(-40px, -20px, 0) scale(1);
    }
    50% {
        transform: translate3d(-320px, 40px, 0) scale(1.08);
    }
    100% {
        transform: translate3d(-40px, -20px, 0) scale(1);
    }
}

@keyframes ppcGlowTraverse2 {
    0% {
        transform: translate3d(40px, 20px, 0) scale(1);
    }
    50% {
        transform: translate3d(340px, -30px, 0) scale(1.06);
    }
    100% {
        transform: translate3d(40px, 20px, 0) scale(1);
    }
}

/* Extra explicit stop for PPC welcome animations */
@media (prefers-reduced-motion: reduce) {
    .ppc-welcome-gradient::before,
    .ppc-welcome-gradient::after,
    .ppc-welcome-glow-1,
    .ppc-welcome-glow-2 {
        animation: none !important;
    }
}

/* ------------------------------
   Sprint 2: Reduced motion (global guard)
   - BottomSheet, ProgressBar, welcome micro-flair
------------------------------ */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
        scroll-behavior: auto !important;
    }
}

/* ------------------------------
   Sprint 2: Optional overlay polish (BottomSheet)
   - Safe to keep even if unused
------------------------------ */
.fp-scrim {
    -webkit-backdrop-filter: blur(2px);
    backdrop-filter: blur(2px);
}

/* ------------------------------
   Sprint 2: Optional tap feedback helper (Welcome CTA)
   - Use by adding className="fp-tap" where needed
------------------------------ */
.fp-tap {
    transition: transform 120ms ease;
}
.fp-tap:active {
    transform: scale(0.98);
}

/* ------------------------------------------------------------------
   PPC Welcome: AAA panel framing + noise + preview stack (NEW)
------------------------------------------------------------------ */

/* Accent-stroke border that feels “designed”, not default */
.ppc-hero-frame {
    position: relative;
    border-radius: 1rem; /* matches rounded-2xl */
    background: var(--ppc-panel-bg);
    border: 1px solid var(--border);
    overflow: hidden;
}

.ppc-hero-frame::before {
    content: "";
    position: absolute;
    inset: 0;
    padding: 1px; /* stroke thickness */
    border-radius: 1rem;
    background: linear-gradient(
            135deg,
            var(--ppc-accent-stroke),
            transparent 35%,
            var(--ppc-accent-stroke-2)
    );
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
    opacity: 0.9;
}

/* Subtle “glass” inner sheen */
.ppc-hero-sheen {
    pointer-events: none;
    position: absolute;
    inset: 0;
    background: radial-gradient(
            900px 420px at 18% 8%,
            var(--ppc-panel-inner) 0%,
            transparent 60%
    );
    opacity: 0.55;
}

/* Fine grain/noise overlay so gradients don’t look templated */
.ppc-hero-noise {
    pointer-events: none;
    position: absolute;
    inset: 0;
    opacity: var(--ppc-noise-opacity);
    background-image:
            radial-gradient(circle at 20% 20%, rgba(255,255,255,0.6) 0 1px, transparent 1px),
            radial-gradient(circle at 80% 30%, rgba(255,255,255,0.45) 0 1px, transparent 1px),
            radial-gradient(circle at 35% 75%, rgba(255,255,255,0.35) 0 1px, transparent 1px),
            radial-gradient(circle at 72% 80%, rgba(255,255,255,0.25) 0 1px, transparent 1px);
    background-size: 120px 120px, 160px 160px, 210px 210px, 260px 260px;
    mix-blend-mode: overlay;
}

/* Premium chip */
.ppc-chip {
    background: var(--ppc-chip-bg);
    border: 1px solid var(--ppc-chip-border);
    border-radius: 9999px;
}

/* Primary CTA polish (keeps Tailwind compatibility) */
.ppc-primary-btn {
    box-shadow: 0 10px 30px var(--ppc-cta-shadow);
}
.ppc-primary-btn:hover {
    transform: translateY(-1px);
}
.ppc-primary-btn:active {
    transform: translateY(0px) scale(0.98);
}

/* Preview stack (right side) */
.ppc-preview-stack {
    position: relative;
    width: 280px;
    height: 170px;
}

.ppc-preview-card {
    position: absolute;
    inset: 0;
    border-radius: 16px;
    border: 1px solid var(--border);
    background: color-mix(in srgb, var(--card) 85%, transparent);
    box-shadow: 0 18px 50px rgba(0, 0, 0, 0.18);
    overflow: hidden;
    will-change: transform;
}

.ppc-preview-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(
            420px 160px at 20% 0%,
            rgba(255, 255, 255, 0.12) 0%,
            transparent 60%
    ),
    radial-gradient(
            420px 160px at 80% 100%,
            rgba(255, 255, 255, 0.08) 0%,
            transparent 55%
    );
    pointer-events: none;
}

.ppc-preview-card-1 {
    transform: translate3d(0, 0, 0) rotate(-1.2deg);
    animation: ppcFloat1 7.2s ease-in-out infinite;
}
.ppc-preview-card-2 {
    transform: translate3d(10px, 14px, 0) rotate(1.0deg) scale(0.98);
    opacity: 0.85;
    animation: ppcFloat2 8.4s ease-in-out infinite;
}
.ppc-preview-card-3 {
    transform: translate3d(20px, 28px, 0) rotate(-0.6deg) scale(0.96);
    opacity: 0.7;
    animation: ppcFloat3 9.6s ease-in-out infinite;
}

@keyframes ppcFloat1 {
    0% { transform: translate3d(0, 0, 0) rotate(-1.2deg); }
    50% { transform: translate3d(0, -6px, 0) rotate(-0.6deg); }
    100% { transform: translate3d(0, 0, 0) rotate(-1.2deg); }
}
@keyframes ppcFloat2 {
    0% { transform: translate3d(10px, 14px, 0) rotate(1.0deg) scale(0.98); }
    50% { transform: translate3d(12px, 8px, 0) rotate(0.6deg) scale(0.985); }
    100% { transform: translate3d(10px, 14px, 0) rotate(1.0deg) scale(0.98); }
}
@keyframes ppcFloat3 {
    0% { transform: translate3d(20px, 28px, 0) rotate(-0.6deg) scale(0.96); }
    50% { transform: translate3d(18px, 34px, 0) rotate(-0.2deg) scale(0.965); }
    100% { transform: translate3d(20px, 28px, 0) rotate(-0.6deg) scale(0.96); }
}

@media (prefers-reduced-motion: reduce) {
    .ppc-primary-btn:hover,
    .ppc-primary-btn:active {
        transform: none !important;
    }
    .ppc-preview-card-1,
    .ppc-preview-card-2,
    .ppc-preview-card-3 {
        animation: none !important;
    }
}
